<!doctype html>
<html>
<head>
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport"
	content="widt=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0">
<title>威视</title>
<link type="text/css" rel="stylesheet" href="css/main.css">

<!-- bootstrap -->
<link href="http://cdn.staticfile.org/twitter-bootstrap/3.3.1/css/bootstrap.min.css" rel="stylesheet">
<!-- bootstrap-select -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/bootstrap-select/1.12.4/css/bootstrap-select.min.css">

<link type="text/css" rel="stylesheet" href="css/style.css">

<style type="text/css">
	.bootstrap-select>.dropdown-toggle {    
		height: 36px;
	}
	.bootstrap-select.btn-group .dropdown-menu.inner{
	    min-height: 32px !important;
	    max-height: 130px !important;
	}
	.bootstrap-select, .btn-default, .dropdown-toggle, 	.dropdown-menu {
		background: transparent !important;
	    border: 0;
	    color: #fff !important;
	}
	.caret {
		display: none;
	}
	.inp select{
		appearance:none;
		-moz-appearance:none; /* Firefox */
		-webkit-appearance:none; /* Safari 和 Chrome */
	}
	.checkboxleft{
		right: 3rem;
    	top: -1rem;
    	margin-right: 10px;
	}
	.checkboxright{
		right: 0;
    	margin: -0.1rem !important;
	}
	.bootstrap-select.btn-group .no-results {
		background-color: transparent !important;
	}
	.checkb {
		position: relative;
	}
	.spanlab{
		background-color: transparent;
	    width: 1.4rem;
	    height: 1.6rem;
	    position: absolute;
	    top: 1rem;
	}
</style>
</head>
<body onresize="document.activeElement.scrollIntoView(true);">

	<div class="swiper-slide loading-page page3">
		<div class="page-center">
			<div class="top">
				<div class="img">
					<img src="images/page3-logo.png">
				</div>
				<div class="img">
					<img src="images/page3-logo1.png">
				</div>
			</div>

			<div class="content-des">
				<table>
					<tr>
						<td><span class="triangle-right"></span>
						 <span>活动时间:</span></td>
						<td>
							<p>9月19日 下午13:00-17:00</p>
							<p>9月20日 上午09:30-12:00</p>
						</td>
					</tr>
					<tr>
						<td><span class="triangle-right"></span> <span>活动地点:</span>

						</td>
						<td>同方威视密云厂区9号厂房</td>
					</tr>
					<tr>
						<td><span class="triangle-right"></span> <span>活动地址:</span>
						</td>
						<td>北京市密云区园林路18号</td>
					</tr>
				</table>
				<hr />
			</div>
		</div>

		<div class="sign-up">
			<p>预定报名</p>
			<div class="inp">
				<span>姓名</span> <input type="text" name="realName"  placeholder="请输入姓名" id="realName">
			</div>
			<div class="wyInput inp" id="myInput">
		      <div class="wyinput-group">
		         <span>部门</span>  <input type="text" placeholder="请选择部门" name="moduleId" id="moduleId" >
		      </div>
		      <div class="wyinput-drop"></div>
			</div>

			<span class="tips">˙(请输入区域中心/事业部/职能部门，请勿输入二级部门)</span>

			<div class="inp">
				<span>电话</span> <input type="text" maxlength="11" name="phone" id="phone" placeholder="请输入电话">
			</div>
			<div class="inp checkb">
				<span>是否乘坐班车</span>
				<div class="checkout-box">
					<div class="checkbox checkboxleft" onclick="showIsbusTime()">
						<span>是</span> 
						<input type="radio" name="selfProjAuth" value="1">
							<label for="btn1"></label>
					</div>
					<div class="checkbox checkboxright" onclick="hideIsbusTime()">
						<span>否</span> 
						<input type="radio"  name="selfProjAuth"
							value="0"><label for="btn1"></label>
					</div>
				</div>
				<div style="clear: both;"></div>
			</div>
			<div class="inp isbus" style="position: relative;">
				<span>您想乘坐哪班车</span> 
				<select name="descn" id="descn">
					<option value="9月19日发车13:00,返程17:00">9月19日发车13:00,返程17:00</option>
					<option value="9月20日发车8:30,返程12:30">9月20日发车8:30,返程12:30</option>
				</select> 
				<span class="triangle-right triangle-down" >
					<label for="descn" class="spanlab"></label></span>
			</div>
			<div class="btn-save" onclick="subData()">提交</div>
		</div>
	</div>


	<script type="text/javascript" src="js/jquery.min.js"></script>
	<script src="http://res.wx.qq.com/open/js/jweixin-1.2.0.js"></script>
	<script src="js/wy_select.js"></script>
	<script src="js/main.js"></script>
	
	<!-- bootstrap -->
	<script src="http://cdn.staticfile.org/twitter-bootstrap/3.3.1/js/bootstrap.min.js" type="text/javascript"></script>
	<!-- bootstrap-select -->
	<script src="https://cdnjs.cloudflare.com/ajax/libs/bootstrap-select/1.12.4/js/bootstrap-select.min.js"></script>
	<script type="text/javascript">
        if(/os 12/ig.test(navigator.userAgent)){
            document.body.addEventListener('blur',function(){
                window.scrollTo(0,0);
            },true);
        }
        $('body').height($('body')[0].clientHeight);//填写表单时候的bug
		$(function() {
			 // $("#myInput").wy_inselect([{name:'紫色'},{name:'yellow'},{name:'pink'},{name:'whrite'},{name:'yellow1'},{name:'yellow2'},{name:'yellow3'},{name:'yellow4'}]); 
			 //showIsbusTime();

			//获取所有部门信息
			$.ajax({
				type : 'post',
				url : 'http://ws.ruikj.cn/apply/api/getModuleList',
				dataType : 'json',
				async : false,
				success : function(data) {
					console.log(data);
					if (data.code == "200") {
						var dataList = data.DataList;
						let _len = data.DataList.length;
						let dataArr = []
						for(let i=0; i<_len; i++){
							dataArr.push({name:dataList[i].moduleName, id: dataList[i].id})
						}
						console.log('dataArr:', dataArr) 
						 $("#myInput").wy_inselect(dataArr); 

						// var html = "";
						// for( var i in dataList){
						// 	html += '<option value="'+dataList[i].id+'">'+dataList[i].moduleName+'</option>';
						// }
						// $("#moduleId").html(html);
					} else {
						console.log(data.msg);
					}
				}
			});
			//加载列表
			$(".selectpicker" ).selectpicker('refresh');
		})
		
		function subData(){
			var realName = $("#realName").val();
			if (realName.length == 0) {
          alert("请填写姓名！");
          return false;
      }
			var moduleId = $("#moduleId").val();
			if (moduleId.length == 0) {
          alert("请填写部门！");
          return false;
      }
			var phone = $("#phone").val();
			if (phone.length == 0) {
          alert("请填写手机号！");
          return false;
      }else{
    	  var phoneNumReg = /^1[3|4|5|7|8]\d{9}$/
    		  if(!phoneNumReg.test(phone)) {
    			  alert('手机号码有误，请重试!');
    			  return false;
    		}
      }
			var selfProjAuth = $('input[name="selfProjAuth"]:checked').val(); 
			if (selfProjAuth.length == 0) {
          alert("请选择是否乘坐班车！");
          return false;
      }
			
			var descn = $("#descn").val();
			var selfProjAuth;
			var obj = document.getElementsByName("selfProjAuth");
			var check_val = [];
			for (var k in obj) {
				if (obj[k].checked)
					selfProjAuth = obj[k].value;
			}
			//组装数据
			var data = {
					"realname" : realName,
					"phone" : phone,
					"moduleId" : moduleId,
					"descn" : descn,
					"selfprojauth" : selfProjAuth
			}
			//提交信息
			$.ajax({
				type : 'post',
				data : data,
				url : 'http://ws.ruikj.cn/apply/api/saveApplyData',
				dataType : 'json',
				async : false,
				success : function(data) {
					console.log(data);
					if (data.code == "200") {
						//渲染首页频道列表
						alert("您已成功报名！我们将会与您联系确认参会事宜。")
					} else {
						console.log(data.msg);
					}
				}
			});
		}

		function showIsbusTime() {
			$(".isbus").css("display", "block");
		}
		function hideIsbusTime() {
			$(".isbus").css("display", "none");
		}

	</script>
</body>
</html>
